
--4. Write SQLQuery to retrieve the following information
--a. Get the number of books written by a given author

------------------------------------------------------------------------------------------------------------------------------------------------

	SELECT * from books;
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	| book_id | title      | volume | status | lang_id | published_date | publisher_id | mrp  |
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	|       1 | Spider Man |      1 | lost   |      12 | 2002-09-12     |         1002 |  100 |
	|       2 | Iron Man   |     12 | lost   |      12 | 2005-05-30     |         1002 |  200 |
	|       3 | Super Man  |     12 | lost   |      12 | 2007-05-20     |         1003 |  250 |
	+---------+------------+--------+--------+---------+----------------+--------------+------+

	SELECT * from book_author;
	+---------+-----------+
	| book_id | author_id |
	+---------+-----------+
	|       1 |       102 |
	|       2 |       102 |
	|       3 |       103 |
	+---------+-----------+

	SELECT * from author;
	+-----------+-----------+-------------+---------+-----------+
	| author_id | status    | email       | name    | phn_no    |
	+-----------+-----------+-------------+---------+-----------+
	|       100 | available | s@gmail.com | Joey    |  12345666 |
	|       102 | lost      | q@gmail.com | Max     | 980754556 |
	|       103 | lost      | w@gmail.com | William | 342344556 |
	+-----------+-----------+-------------+---------+-----------+


	SELECT
	    author.name AS author_name,
	    COUNT(book_author.book_id) AS book_count
	FROM
	    author
	JOIN
	    book_author ON author.author_id = book_author.author_id
	GROUP BY
	    author.author_id;
	+---------+----------------+
	| name    | count(book_id) |
	+---------+----------------+
	| Max     |              2 |
	| William |              1 |
	+---------+----------------+


------------------------------------------------------------------------------------------------------------------------------------------------


--b. Get the list of publishers and the number of books published by each publisher


------------------------------------------------------------------------------------------------------------------------------------------------

	SELECT * from publisher;
	+--------------+-------------+------------+
	| publisher_id | name        | address    |
	+--------------+-------------+------------+
	|         1001 | Warner Bros | California |
	|         1002 | Marvel      | USA        |
	|         1003 | DC          | Albania    |
	+--------------+-------------+------------+

	SELECT * from books;
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	| book_id | title      | volume | status | lang_id | published_date | publisher_id | mrp  |
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	|       1 | Spider Man |      1 | lost   |      12 | 2002-09-12     |         1002 |  100 |
	|       2 | Iron Man   |     12 | lost   |      12 | 2005-05-30     |         1002 |  200 |
	|       3 | Super Man  |     12 | lost   |      12 | 2007-05-20     |         1003 |  250 |
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	

	SELECT
	    publisher.name AS publisher_name,
	    COUNT(books.book_id) AS book_count
	FROM
	    publisher
	JOIN
	    books ON publisher.publisher_id = books.publisher_id
	GROUP BY
	    publisher.publisher_id;
	+----------------+------------+
	| publisher_name | book_count |
	+----------------+------------+
	| Marvel         |          2 |
	| DC             |          1 |
	+----------------+------------+


------------------------------------------------------------------------------------------------------------------------------------------------


--d. Get the list of books that are issued but not returned


------------------------------------------------------------------------------------------------------------------------------------------------

	SELECT * from book_issue;
	+----------+-----------+---------+----------+---------------+-------------------------+
	| issue_id | member_id | book_id | status   | date_of_issue | expected_date_of_return |
	+----------+-----------+---------+----------+---------------+-------------------------+
	|     1111 |         1 |       1 | issued   | 2022-09-08    | 2022-09-18              |
	|     2222 |         2 |       2 | issued   | 2023-09-05    | 2023-09-15              |
	|     3333 |         3 |       3 | returned | 2022-10-06    | 2022-11-19              |
	+----------+-----------+---------+----------+---------------+-------------------------+

	SELECT * from books;
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	| book_id | title      | volume | status | lang_id | published_date | publisher_id | mrp  |
	+---------+------------+--------+--------+---------+----------------+--------------+------+
	|       1 | Spider Man |      1 | lost   |      12 | 2002-09-12     |         1002 |  100 |
	|       2 | Iron Man   |     12 | lost   |      12 | 2005-05-30     |         1002 |  200 |
	|       3 | Super Man  |     12 | lost   |      12 | 2007-05-20     |         1003 |  250 |
	+---------+------------+--------+--------+---------+----------------+--------------+------+


	SELECT
	    books.title,
	    book_issue.status
	FROM
	    books
	JOIN
	    book_issue ON books.book_id = book_issue.book_id
	WHERE
	    book_issue.status = 'issued';
	+------------+--------+
	| title      | status |
	+------------+--------+
	| Spider Man | issued |
	| Iron Man   | issued |
	+------------+--------+


------------------------------------------------------------------------------------------------------------------------------------------------


--e. Get the list of students who reads only ‘Malayalam’ books


------------------------------------------------------------------------------------------------------------------------------------------------

	SELECT * FROM member;
	+-----------+--------------+-----------------+-----------+---------+-------------+-------------+---------+
	| member_id | data_of_join | email           | phn_no    | roll_no | name        | branch_code | status  |
	+-----------+--------------+-----------------+-----------+---------+-------------+-------------+---------+
	|         1 | 2022-02-20   | f@gmail.com     | 123123123 |      31 | Fuhad Sanin |         202 | Present |
	|         2 | 2022-02-28   | a@gmail.com     |    999123 |       1 | Adithya Sai |         201 | Present |
	|         3 | 2022-03-30   | aarya@gmail.com | 923499123 |       2 | Aarya       |         201 | Present |
	|         4 | 2003-04-23   | shan@gmail.com  |  32423432 |      28 | Fariz       |         902 | Present |
	+-----------+--------------+-----------------+-----------+---------+-------------+-------------+---------+

	SELECT * FROM language;
	+---------+-----------+
	| lang_id | name      |
	+---------+-----------+
	|      11 | English   |
	|      12 | Malayalam |
	|    1001 | Jony      |
	+---------+-----------+

	SELECT * FROM book_issue;
	+----------+-----------+---------+----------+---------------+-------------------------+
	| issue_id | member_id | book_id | status   | date_of_issue | expected_date_of_return |
	+----------+-----------+---------+----------+---------------+-------------------------+
	|     1111 |         1 |       1 | issued   | 2022-09-08    | 2022-09-18              |
	|     2222 |         2 |       2 | issued   | 2023-09-05    | 2023-09-15              |
	|     3333 |         3 |       3 | returned | 2022-10-06    | 2022-11-19              |
	+----------+-----------+---------+----------+---------------+-------------------------+

	SELECT * from books;
	+---------+--------------+--------+-----------+---------+----------------+--------------+------+
	| book_id | title        | volume | status    | lang_id | published_date | publisher_id | mrp  |
	+---------+--------------+--------+-----------+---------+----------------+--------------+------+
	|       1 | Spider Man   |      1 | lost      |      12 | 2002-09-12     |         1002 |  100 |
	|       2 | Iron Man     |     12 | lost      |      12 | 2005-05-30     |         1002 |  200 |
	|       3 | Super Man    |     12 | lost      |      12 | 2007-05-20     |         1003 |  250 |
	|       4 | Helen KEller |      2 | Available |      11 | 2004-09-07     |         1001 |  300 |
	+---------+--------------+--------+-----------+---------+----------------+--------------+------+

	SELECT
	    member.name,
	    language.name
	FROM
	    member,
	    book_issue,
	    books,
	    language
	WHERE
	    member.member_id = book_issue.member_id
	    AND book_issue.book_id = books.book_id
	    AND books.lang_id = language.lang_id
	    AND language.name = 'Malayalam';

	+-------------+-----------+
	| name        | name      |
	+-------------+-----------+
	| Fuhad Sanin | Malayalam |
	| Adithya Sai | Malayalam |
	| Aarya       | Malayalam |
	+-------------+-----------+



